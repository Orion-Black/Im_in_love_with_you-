<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fuegos Artificiales ‚Äî Girasol Sim√©trico</title>
  <style>
    html,body{
      height:100%;
      margin:0;
      background:#000;
      overflow:hidden;
      font-family: 'Segoe UI', Roboto, Arial, sans-serif;
    }
    #background{
      position:fixed;
      inset:0;
      z-index:0;
      overflow:hidden;
      background:linear-gradient(180deg,#050505 0%, #0b0b0b 100%);
    }
    .blur-light{
      position:absolute;
      filter: blur(40px) saturate(1.2);
      opacity:0.45;
      pointer-events:none;
      mix-blend-mode:screen;
      transform: translate3d(0,0,0);
      animation: moveLight linear infinite;
    }
    @keyframes moveLight {
      0%{ transform: translateY(0) translateX(0) scale(1); opacity:.55; }
      50%{ transform: translateY(-50px) translateX(25px) scale(1.03); opacity:.9; }
      100%{ transform: translateY(0) translateX(0) scale(1); opacity:.55; }
    }

    #fireworksCanvas{
      position:fixed;
      inset:0;
      z-index:1;
      display:block;
    }

    #message{
      position:fixed;
      left:50%;
      top:50%;
      transform: translate(-50%, -50%);
      z-index:2;
      background: rgba(255,255,255,0.92);
      padding: 22px 32px;
      border-radius: 14px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.55);
      text-align:center;
      max-width:90%;
      animation: floatUp 1s ease-out both;
    }
    #message h1{
      margin:0 0 6px 0;
      font-size:26px;
      color:#222;
    }
    #message p{ margin:0; color:#444; font-size:14px; }

    @keyframes floatUp{
      from{ transform: translate(-50%, 60%) scale(.98); opacity:0; }
      to{ transform: translate(-50%, -50%) scale(1); opacity:1; }
    }

    @media (max-width:520px){
      #message{ padding:14px 16px; border-radius:12px; }
      #message h1{ font-size:18px; }
    }
  </style>
</head>
<body>
  <div id="background"></div>
  <canvas id="fireworksCanvas"></canvas>

  <div id="message">
    <h1>¬°Feliz d√≠a!</h1>
    <p>Disfruta los girasoles üåª preciosa üíó </p>
  </div>

<script>
/* --------------------------
   Setup canvas y fondo
   -------------------------- */
const bg = document.getElementById('background');
const canvas = document.getElementById('fireworksCanvas');
const ctx = canvas.getContext('2d', { alpha: true });

function fitCanvas(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
fitCanvas();
window.addEventListener('resize', fitCanvas);

const lightCount = 18;
const lightColors = [
  'rgba(255,180,120,0.8)',
  'rgba(120,180,255,0.68)',
  'rgba(255,220,120,0.6)',
  'rgba(200,120,220,0.62)'
];
for(let i=0;i<lightCount;i++){
  const d = document.createElement('div');
  d.className = 'blur-light';
  const size = Math.round((Math.random()*0.16 + 0.07) * Math.max(window.innerWidth, window.innerHeight));
  d.style.width = `${size}px`;
  d.style.height = `${size}px`;
  d.style.left = `${Math.random()*100}%`;
  d.style.top = `${Math.random()*100}%`;
  d.style.background = `radial-gradient(circle at 30% 30%, ${lightColors[Math.floor(Math.random()*lightColors.length)]}, rgba(0,0,0,0))`;
  d.style.animationDuration = `${10 + Math.random()*20}s`;
  d.style.opacity = 0.3 + Math.random()*0.4;
  bg.appendChild(d);
}

/* --------------------------
   Fecha: comprobar 21 de septiembre
   -------------------------- */
function es21Septiembre(){
  const now = new Date();
  return (now.getMonth() === 8) && (now.getDate() === 22);
}

/* --------------------------
   Clases base: Particle (brillos/sparks)
   -------------------------- */
class Particle {
  constructor(x,y, vx, vy, color, radius=2, life=70){
    this.x = x; this.y = y;
    this.vx = vx; this.vy = vy;
    this.color = color;
    this.radius = radius;
    this.life = life;
    this.age = 0;
    this.alpha = 1;
  }

  update(){
    // f√≠sica simple
    this.vy += 0.02; // gravedad leve
    this.x += this.vx;
    this.y += this.vy;
    // fricci√≥n leve para evitar part√≠culas infinitas
    this.vx *= 0.997;
    this.vy *= 0.997;
    this.age++;
    this.alpha = Math.max(0, 1 - this.age/this.life);
  }

  draw(ctx){
    ctx.save();
    ctx.globalAlpha = this.alpha;
    ctx.beginPath();
    ctx.fillStyle = this.color;
    ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2);
    ctx.fill();
    ctx.restore();
  }

  dead(){ return this.age >= this.life; }
}

/* --------------------------
   Petalo simple (forma triangular/ovalo reducida)
   - Dise√±ado para ser sim√©trico
   -------------------------- */
class SimplePetal {
  constructor(cx, cy, angle, length, width, colorOuter, colorInner){
    this.cx = cx; this.cy = cy;
    this.angle = angle;
    this.length = length;
    this.width = width;
    this.colorOuter = colorOuter; // punta (m√°s brillante)
    this.colorInner = colorInner; // base (m√°s oscuro)
    this.grow = 0; // animaci√≥n de crecimiento 0..1
    this.age = 0;
    this.life = 110;
    // ligera variaci√≥n para que no sea completamente id√©ntico
    this.variation = (Math.random()*0.12 - 0.06);
  }

  update(){
    // crecimiento r√°pido al inicio para efecto de explosi√≥n
    this.grow = Math.min(1, this.grow + 0.07);
    this.age++;
  }

  draw(ctx, timeNow){
  const g = this.grow;
  const ang = this.angle + this.variation;
  // punto medio del petalo (no muy usado, solo referencia)
  const mx = this.cx + Math.cos(ang) * (this.length * 0.5 * g);
  const my = this.cy + Math.sin(ang) * (this.length * 0.5 * g);

  ctx.save();
  ctx.translate(this.cx, this.cy);
  ctx.rotate(ang);

  // forma puntiaguda: base m√°s estrecha y punta m√°s alargada
  const bw = this.width * g;
  const lh = this.length * g;

  // Dibujar la forma: base cerca del centro, punta muy hacia -lh*1.15 para hacerla puntiaguda
  ctx.beginPath();
  // base izquierda (m√°s cerca del eje para punta)
  ctx.moveTo(-bw*0.5, 6);
  // curva a la punta (control point m√°s alto -> punta m√°s aguda)
  ctx.quadraticCurveTo(0, -lh*1.15, bw*0.5, 6);
  ctx.lineTo(bw*0.5, 6);
  ctx.closePath();

  // gradiente vertical para volumen
  const grad = ctx.createLinearGradient(0, 8, 0, -lh);
  grad.addColorStop(0, this.colorInner);
  grad.addColorStop(1, this.colorOuter);

  ctx.fillStyle = grad;
  ctx.fill();

  // brillo m√°s fino en el costado superior para dar sensaci√≥n de borde
  ctx.beginPath();
  ctx.globalAlpha = 0.22 * (0.6 + 0.4*Math.sin(timeNow*0.02 + this.age*0.08));
  ctx.moveTo(-bw*0.3, 2);
  ctx.quadraticCurveTo(0, -lh*0.75, bw*0.3, 2);
  ctx.lineTo(bw*0.3, 0);
  ctx.quadraticCurveTo(0, -lh*0.55, -bw*0.3, 0);
  ctx.fillStyle = 'rgba(255,255,200,0.82)';
  ctx.fill();

  ctx.restore();
}
  

  dead(){ return this.age >= this.life; }
}

/* --------------------------
   Firework: comportamiento de subida y explosi√≥n
   -------------------------- */
class Firework {
  constructor(x, y, targetY, color, type='default'){
    this.x = x; this.y = y;
    this.startY = y;
    this.targetY = targetY;
    this.speed = 4 + Math.random()*1.6;
    this.color = color;
    this.exploded = false;
    this.particles = [];
    this.type = type; // 'sunflower' o 'default'
    this._center = null;
  }

  update(){
    if(!this.exploded){
      this.y -= this.speed;
      this.x += Math.sin(this.y*0.05 + (this.x%20))*0.35;
      if(this.y <= this.targetY){
        this.explode();
      }
    } else {
      for(let i=this.particles.length-1;i>=0;i--){
        const p = this.particles[i];
        if(p.update) p.update();
        if(p.dead && p.dead()){
          this.particles.splice(i,1);
        }
      }
    }
  }

  draw(ctx, timeNow){
    if(!this.exploded){
      // proyectil
      ctx.save();
      ctx.beginPath();
      ctx.fillStyle = this.color;
      ctx.shadowColor = this.color;
      ctx.shadowBlur = 10;
      ctx.arc(this.x, this.y, 3.5, 0, Math.PI*2);
      ctx.fill();
      ctx.restore();
    } else {
      // dibuja part√≠culas y p√©talos
      for(const p of this.particles){
        if(p.draw) p.draw(ctx, timeNow);
        else if(p instanceof Particle) p.draw(ctx);
      }

      // centro brillante (si existe)
      if(this._center){
        const c = this._center;
        // glow radial
        const rg = ctx.createRadialGradient(c.x, c.y, 0, c.x, c.y, 48);
        rg.addColorStop(0, 'rgba(255,230,160,0.95)');
        rg.addColorStop(0.12, 'rgba(220,170,100,0.95)');
        rg.addColorStop(0.4, 'rgba(140,90,40,0.6)');
        rg.addColorStop(1, 'rgba(0,0,0,0)');
        ctx.save();
        ctx.globalCompositeOperation = 'lighter';
        ctx.fillStyle = rg;
        ctx.beginPath();
        ctx.arc(c.x, c.y, 48, 0, Math.PI*2);
        ctx.fill();

        // c√≠rculo central simple y definido (marr√≥n)
        ctx.globalCompositeOperation = 'source-over';
        ctx.beginPath();
        ctx.fillStyle = 'rgba(95,50,20,1)'; // caf√©
        ctx.arc(c.x, c.y, 16, 0, Math.PI*2);
        ctx.fill();

        // peque√±o brillo superior izquierdo
        ctx.beginPath();
        ctx.fillStyle = 'rgba(220,160,90,0.28)';
        ctx.arc(c.x-5, c.y-5, 5, 0, Math.PI*2);
        ctx.fill();
        ctx.restore();
      }
    }
  }

  explode(){
    this.exploded = true;
    const cx = this.x;
    const cy = this.y;
    const isSun = this.type === 'sunflower';

    if(isSun){
      // Simetr√≠a: generar p√©talos distribuidos uniformemente
      this._center = { x: cx, y: cy };

      // par√°metros simples y sim√©tricos para mantener apariencia 'fuego artificial'
      const petalCount = 12 + (Math.random() < 0.5 ? 0 : 2); // 12 √≥ 14 p√©talos (sim√©tricos)
      const baseLength = 48 + Math.random()*18;
      const baseWidth = 14 + Math.random()*6;

      for(let i=0;i<petalCount;i++){
        const angle = (i / petalCount) * Math.PI*2;
        // mantener muy poca variaci√≥n para simetr√≠a
        const len = baseLength * (0.95 + Math.random()*0.08);
        const wid = baseWidth * (0.95 + Math.random()*0.08);
        // tonos amarillos sencillos: interior algo oscuro, exterior brillante
        const inner = 'rgba(210,160,20,1)';
        const outer = 'rgba(255,220,50,1)';
        const pet = new SimplePetal(cx, cy, angle, len, wid, outer, inner);
        this.particles.push(pet);
      }

      // polvo/semillas: pocas motas marrones para dar centro texturizado
      const dustCount = 22;
      for(let i=0;i<dustCount;i++){
        const a = Math.random()*Math.PI*2;
        const r = 6 + Math.random()*26;
        const vx = Math.cos(a)*(0.4 + Math.random()*1.0);
        const vy = Math.sin(a)*(0.4 + Math.random()*1.0);
        const px = cx + Math.cos(a)*6;
        const py = cy + Math.sin(a)*6;
        const shade = 40 + Math.floor(Math.random()*70);
        const color = `rgba(${Math.floor(shade*0.8)},${Math.floor(shade*0.5)},${Math.floor(shade*0.25)},1)`;
        const part = new Particle(px, py, vx, vy, color, 2 + Math.random()*2, 70 + Math.floor(Math.random()*40));
        this.particles.push(part);
      }

      // destellos amarillos r√°pidos y cortos para mantener 'fuego artificial' feeling
      const sparks = 28;
      for(let i=0;i<sparks;i++){
        const a = Math.random()*Math.PI*2;
        const speed = 1.6 + Math.random()*1.8;
        const vx = Math.cos(a)*speed;
        const vy = Math.sin(a)*speed;
        const col = `rgba(255,230,120,${0.85 - Math.random()*0.45})`;
        const p = new Particle(cx, cy, vx, vy, col, 1.2 + Math.random()*1.6, 48 + Math.floor(Math.random()*36));
        this.particles.push(p);
      }

    } else {
      // explosi√≥n por defecto: part√≠culas circulares
      const count = 80;
      for(let i=0;i<count;i++){
        const t = Math.random()*Math.PI*2;
        const speed = 1.2 + Math.random()*3.0;
        const vx = Math.cos(t)*speed;
        const vy = Math.sin(t)*speed;
        const col = this.color;
        const p = new Particle(cx, cy, vx, vy, col, 2 + Math.random()*2.2, 60 + Math.floor(Math.random()*70));
        this.particles.push(p);
      }
    }
  }

  done(){
    return this.exploded && this.particles.length === 0;
  }
}

/* --------------------------
   Loop principal
   -------------------------- */
let fireworks = [];
const colors = ['#ff6b6b','#ffd166','#9b5de5','#00bcd4','#ffafcc','#ffd54f','#8bd346'];

function maybeLaunch(){
  // probabilidad de lanzamiento cada frame
  if(Math.random() < 0.05){
    const x = 60 + Math.random()*(canvas.width-120);
    const y = canvas.height + 10;
    const targetY = 90 + Math.random()*(canvas.height*0.45);
    const tipo = es21Septiembre() ? 'sunflower' : 'default';
    const color = colors[Math.floor(Math.random()*colors.length)];
    fireworks.push(new Firework(x, y, targetY, color, tipo));
  }
}

let lastTime = performance.now();
function animate(t){
  const dt = t - lastTime;
  lastTime = t;

  // limpiar con estela
  ctx.globalCompositeOperation = 'source-over';
  ctx.fillStyle = 'rgba(0,0,0,0.16)';
  ctx.fillRect(0,0,canvas.width, canvas.height);

  maybeLaunch();

  for(let i=fireworks.length-1;i>=0;i--){
    const fw = fireworks[i];
    fw.update();
    fw.draw(ctx, t);
    if(fw.done()) fireworks.splice(i,1);
  }

  requestAnimationFrame(animate);
}
requestAnimationFrame(animate);

/* interacci√≥n: lanzar en la posici√≥n clickeada */
canvas.addEventListener('pointerdown', (e)=>{
  const rect = canvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  const fy = canvas.height + 8;
  const tipo = es21Septiembre() ? 'sunflower' : 'default';
  const color = colors[Math.floor(Math.random()*colors.length)];
  fireworks.push(new Firework(x, fy, y, color, tipo));
});

/* Pausar animaci√≥n en segundo plano para ahorro */
document.addEventListener('visibilitychange', ()=>{
  if(!document.hidden) {
    lastTime = performance.now();
    requestAnimationFrame(animate);
  }
});

console.log("Script cargado: en 21 de septiembre las explosiones ser√°n girasoles sim√©tricos.");
</script>
</body>
</html>
